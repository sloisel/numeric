var numeric=typeof exports=="undefined"?function(){}:exports;typeof global!="undefined"&&(global.numeric=numeric),numeric.version="1.0.3",numeric.bench=function(b,c){var d,e,f,g;typeof c=="undefined"&&(c=15),f=1,d=new Date;for(;;){f*=2;for(g=f;g>3;g-=4)b(),b(),b(),b();while(g>0)b(),g--;e=new Date;if(e-d>c)break}for(g=f;g>3;g-=4)b(),b(),b(),b();while(g>0)b(),g--;return e=new Date,1e3*(3*f-1)/(e-d)},numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(b){function c(a){if(a===0)return"0";if(isNaN(a))return"NaN";if(a<0)return"-"+c(-a);if(isFinite(a)){var b=Math.floor(Math.log(a)/Math.log(10)),d=a/Math.pow(10,b),e=d.toPrecision(numeric.precision);return parseFloat(e)===10&&(b++,d=1,e=d.toPrecision(numeric.precision)),parseFloat(e).toString()+"e"+b.toString()}return"Infinity"}function e(a){var b;if(typeof a=="undefined")return d.push(Array(numeric.precision+8).join(" ")),!1;if(typeof a=="string")return d.push('"'+a+'"'),!1;if(typeof a=="boolean")return d.push(a.toString()),!1;if(typeof a=="number"){var f=c(a),g=a.toPrecision(numeric.precision),h=parseFloat(a.toString()).toString(),i=[f,g,h,parseFloat(g).toString(),parseFloat(h).toString()];for(b=1;b<i.length;b++)i[b].length<f.length&&(f=i[b]);return d.push(Array(numeric.precision+8-f.length).join(" ")+f),!1}if(a===null)return d.push("null"),!1;if(typeof a=="function"){d.push(a.toString());var j=!1;for(b in a)a.hasOwnProperty(b)&&(j?d.push(",\n"):d.push("\n{"),j=!0,d.push(b),d.push(": \n"),e(a[b]));return j&&d.push("}\n"),!0}if(a instanceof Array){if(a.length>numeric.largeArray)return d.push("...Large Array..."),!0;var j=!1;d.push("[");for(b=0;b<a.length;b++)b>0&&(d.push(","),j&&d.push("\n ")),j=e(a[b]);return d.push("]"),!0}d.push("{");var j=!1;for(b in a)a.hasOwnProperty(b)&&(j&&d.push(",\n"),j=!0,d.push(b),d.push(": \n"),e(a[b]));return d.push("}"),!0}var d=[];return e(b),d.join("")},numeric.parseDate=function(b){function c(a){if(typeof a=="string")return Date.parse(a.replace(/-/g,"/"));if(a instanceof Array){var b=[],d;for(d=0;d<a.length;d++)b[d]=c(a[d]);return b}throw new Error("parseDate: parameter must be arrays of strings")}return c(b)},numeric.parseFloat=function(b){function c(a){if(typeof a=="string")return parseFloat(a);if(a instanceof Array){var b=[],d;for(d=0;d<a.length;d++)b[d]=c(a[d]);return b}throw new Error("parseFloat: parameter must be arrays of strings")}return c(b)},numeric.parseCSV=function(b){var c=b.split("\n"),d,e,f=[],g=/(([^'",]*)|('[^']*')|("[^"]*")),/g,h=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,i=function(a){return a.substr(0,a.length-1)},j=0;for(e=0;e<c.length;e++){var k=(c[e]+",").match(g),l;if(k.length>0){f[j]=[];for(d=0;d<k.length;d++)l=i(k[d]),h.test(l)?f[j][d]=parseFloat(l):f[j][d]=l;j++}}return f},numeric.toCSV=function(b){var c=numeric.dim(b),d,e,f,g,h,i;f=c[0],g=c[1],i=[];for(d=0;d<f;d++){h=[];for(e=0;e<f;e++)h[e]=b[d][e].toString();i[d]=h.join(", ")}return i.join("\n")+"\n"},numeric.getURL=function(b){var c=new XMLHttpRequest;return c.open("GET",b,!1),c.send(),c},numeric.imageURL=function(b){function c(a){var b=a.length,c,d,e,f,g,h,i,j,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(c=0;c<b;c+=3)d=a[c],e=a[c+1],f=a[c+2],g=d>>2,h=((d&3)<<4)+(e>>4),i=((e&15)<<2)+(f>>6),j=f&63,c+1>=b?i=j=64:c+2>=b&&(j=64),l+=k.charAt(g)+k.charAt(h)+k.charAt(i)+k.charAt(j);return l}function d(a,b,c){typeof b=="undefined"&&(b=0),typeof c=="undefined"&&(c=a.length);var d=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],e=-1,f=0,g=a.length,h;for(h=b;h<c;h++)f=(e^a[h])&255,e=e>>>8^d[f];return e^-1}var e=b[0].length,f=b[0][0].length,g,h,i,j,k,l,m,n,o,p,q,r=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,f&255,e>>24&255,e>>16&255,e>>8&255,e&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];q=d(r,12,29),r[29]=q>>24&255,r[30]=q>>16&255,r[31]=q>>8&255,r[32]=q&255,g=1,h=0;for(n=0;n<e;n++){n<e-1?r.push(0):r.push(1),l=3*f+1+(n===0)&255,m=3*f+1+(n===0)>>8&255,r.push(l),r.push(m),r.push(~l&255),r.push(~m&255),n===0&&r.push(0);for(o=0;o<f;o++)for(j=0;j<3;j++)l=b[j][n][o],l>255?l=255:l<0?l=0:l=Math.round(l),g=(g+l)%65521,h=(h+g)%65521,r.push(l);r.push(0)}return p=(h<<16)+g,r.push(p>>24&255),r.push(p>>16&255),r.push(p>>8&255),r.push(p&255),k=r.length-41,r[33]=k>>24&255,r[34]=k>>16&255,r[35]=k>>8&255,r[36]=k&255,q=d(r,37),r.push(q>>24&255),r.push(q>>16&255),r.push(q>>8&255),r.push(q&255),r.push(0),r.push(0),r.push(0),r.push(0),r.push(73),r.push(69),r.push(78),r.push(68),r.push(174),r.push(66),r.push(96),r.push(130),"data:image/png;base64,"+c(r)},numeric._dim=function(b){var c=[];while(typeof b=="object")c.push(b.length),b=b[0];return c},numeric.dim=function(b){var c,d;if(typeof b=="object")return c=b[0],typeof c=="object"?(d=c[0],typeof d=="object"?numeric._dim(b):[b.length,c.length]):[b.length];return[]},numeric.mapreduce=function(b,c){return numeric.Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+c+";\n"+'if(typeof _s === "undefined") _s = numeric.dim(x);\n'+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i,xi;\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) {\n"+"        accum = arguments.callee(x[i],accum,_s,_k+1);\n"+"    }"+"    return accum;\n"+"}\n"+"for(i=_n-1;i>=1;i-=2) { \n"+"    xi = x[i];\n"+"    "+b+";\n"+"    xi = x[i-1];\n"+"    "+b+";\n"+"}\n"+"if(i === 0) {\n"+"    xi = x[i];\n"+"    "+b+"\n"+"}\n"+"return accum;")},numeric.same=function a(b,c){var d,e;if(b instanceof Array&&c instanceof Array){e=b.length;if(e!==c.length)return!1;for(d=0;d<e;d++){if(b[d]===c[d])continue;if(typeof b[d]!="object")return!1;if(!a(b[d],c[d]))return!1}return!0}return!1},numeric.rep=function(b,c,d){typeof d=="undefined"&&(d=0);var e=b[d],f=Array(e),g;if(d===b.length-1){for(g=e-2;g>=0;g-=2)f[g+1]=c,f[g]=c;return g===-1&&(f[0]=c),f}for(g=e-1;g>=0;g--)f[g]=numeric.rep(b,c,d+1);return f},numeric.dotMMbig=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=numeric.dotVV,x=Math.min;g=b.length,h=c.length,i=c[0].length,j=Array(g),m=numeric.transpose(c);for(n=0;n<g;n+=4){p=x(n+4,g);for(d=n;d<p;d++)j[d]=Array(i);for(o=0;o<i;o+=4){q=x(o+4,i);for(d=n;d<p;d++){l=b[d],k=j[d];for(f=o;f<q;f++)k[f]=w(l,m[f])}}}return j},numeric.dotMMsmall=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;g=b.length,h=c.length,i=c[0].length,j=Array(g);for(d=g-1;d>=0;d--){k=Array(i),l=b[d];for(f=i-1;f>=0;f--){m=l[h-1]*c[h-1][f];for(e=h-2;e>=1;e-=2)n=e-1,m+=l[e]*c[e][f]+l[n]*c[n][f];e===0&&(m+=l[0]*c[0][f]),k[f]=m}j[d]=k}return j},numeric.dotMV=function(b,c){var d=b.length,e=c.length,f,g=Array(d),h=numeric.dotVV;for(f=d-1;f>=0;f--)g[f]=h(b[f],c);return g},numeric.dotVM=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;g=b.length,h=c[0].length,j=Array(h);for(f=h-1;f>=0;f--){m=b[g-1]*c[g-1][f];for(e=g-2;e>=1;e-=2)n=e-1,m+=b[e]*c[e][f]+b[n]*c[n][f];e===0&&(m+=b[0]*c[0][f]),j[f]=m}return j},numeric.dotVV=function(b,c){var d,e=b.length,f,g=b[e-1]*c[e-1];for(d=e-2;d>=1;d-=2)f=d-1,g+=b[d]*c[d]+b[f]*c[f];return d===0&&(g+=b[0]*c[0]),g},numeric.dot=function(b,c){var d=numeric.dim;switch(d(b).length*1e3+d(c).length){case 2002:return c.length<40?numeric.dotMMsmall(b,c):numeric.dotMMbig(b,c);case 2001:return numeric.dotMV(b,c);case 1002:return numeric.dotVM(b,c);case 1001:return numeric.dotVV(b,c);case 1e3:return numeric.mulVS(b,c);case 1:return numeric.mulSV(b,c);case 0:return b*c;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(b){var c,d,e,f=b.length,g=Array(f),h;for(c=f-1;c>=0;c--){h=Array(f),d=c+2;for(e=f-1;e>=d;e-=2)h[e]=0,h[e-1]=0;e>c&&(h[e]=0),h[c]=b[c];for(e=c-1;e>=1;e-=2)h[e]=0,h[e-1]=0;e===0&&(h[0]=0),g[c]=h}return g},numeric.getDiag=function(a){var b=Math.min(a.length,a[0].length),c,d=Array(b);for(c=b-1;c>=1;--c)d[c]=a[c][c],--c,d[c]=a[c][c];return c===0&&(d[0]=a[0][0]),d},numeric.identity=function(b){return numeric.diag(numeric.rep([b],1))},numeric.pointwise=function(b,c,d){typeof d=="undefined"&&(d="");var e=[],f,g=/\[i\]$/,h,i="";for(f=0;f<b.length;f++)g.test(b[f])?(h=b[f].substring(0,b[f].length-3),i=h):h=b[f],e.push(h);return e[b.length]="_s",e[b.length+1]="_k",e[b.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+i+");\n"+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i, ret = Array(_n);\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+b.join(",")+",_s,_k+1);\n"+"    return ret;\n"+"}\n"+d+"\n"+"for(i=_n-1;i>=3;--i) { \n"+"    "+c+"\n"+"    --i;\n"+"    "+c+"\n"+"    --i;\n"+"    "+c+"\n"+"    --i;\n"+"    "+c+"\n"+"}\n"+"while(i>=0) {\n"+"    "+c+"\n"+"    --i;\n"+"}\n"+"return ret;",numeric.Function.apply(null,e)},numeric._biforeach=function b(a,c,d,e,f){if(e===d.length-1){f(a,c);return}var g,h=d[e];for(g=h-1;g>=0;g--)b(a[g],c[g],d,e+1,f)},numeric.anyV=numeric.mapreduce("if(xi) return true;","false"),numeric.allV=numeric.mapreduce("if(!xi) return false;","true"),numeric.any=function(a){return typeof a.length=="undefined"?a:numeric.anyV(a)},numeric.all=function(a){return typeof a.length=="undefined"?a:numeric.allV(a)},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",andeq:"&=",oreq:"|=",xoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"],numeric.ops1={neg:"-",not:"!",bnot:"~"},function(){var a,b;for(a in numeric.ops2)numeric.ops2.hasOwnProperty(a)&&(b=numeric.ops2[a],numeric[a+"VV"]=numeric.pointwise(["x[i]","y[i]"],"ret[i] = x[i] "+b+" y[i];"),numeric[a+"SV"]=numeric.pointwise(["x","y[i]"],"ret[i] = x "+b+" y[i];"),numeric[a+"VS"]=numeric.pointwise(["x[i]","y"],"ret[i] = x[i] "+b+" y;"),numeric[a]=numeric.Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+"SV;\n"+"for(i=1;i!==n;++i) { \n"+"  y = arguments[i];"+'  if(typeof x === "object") {\n'+'      if(typeof y === "object") x = VV(x,y);\n'+"      else x = VS(x,y);\n"+'  } else if(typeof y === "object") x = SV(x,y);\n'+"  else x = x "+b+" y;\n"+"}\nreturn x;\n"),numeric[b]=numeric[a]);for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(b=numeric.ops1[a],numeric[a+"V"]=numeric.pointwise(["x[i]"],"ret[i] = "+b+"x[i];"),numeric[a]=numeric.Function("x",'if(typeof x === "object") return numeric.'+a+"V(x);\nreturn "+b+"(x);"));for(a=0;a<numeric.mathfuns.length;a++)b=numeric.mathfuns[a],numeric[b+"V"]=numeric.pointwise(["x[i]"],"ret[i] = fun(x[i]);","var fun = Math."+b+";"),numeric[b]=numeric.Function("x",'if(typeof x === "object") return numeric.'+b+"V(x);\nreturn Math."+b+"(x);");numeric.isNaNV=numeric.pointwise(["x[i]"],"ret[i] = isNaN(x[i]);"),numeric.isNaN=function c(a){return typeof a=="object"?numeric.isNaNV(a):c(a)},numeric.isFiniteV=numeric.pointwise(["x[i]"],"ret[i] = isFinite(x[i]);"),numeric.isFinite=function(b){return typeof b=="object"?numeric.isFiniteV(b):isFinite(b)};for(a in numeric.opseq)numeric.opseq.hasOwnProperty(a)&&(numeric[a+"S"]=numeric.Function("x","y","var n = x.length, i;\nfor(i=n-1;i>=0;i--) x[i] "+numeric.opseq[a]+" y;"),numeric[a+"V"]=numeric.Function("x","y","var n = x.length, i;\nfor(i=n-1;i>=0;i--) x[i] "+numeric.opseq[a]+" y[i];"),numeric[a]=numeric.Function("x","y",'var s = numeric.dim(x);\nif(typeof y === "number") { numeric._biforeach(x,y,s,0,numeric.'+a+"S); return x; }\n"+"numeric._biforeach(x,y,s,0,numeric."+a+"V);\n"+"return x;"),numeric[numeric.opseq[a]]=numeric[a])}(),numeric.atan2VV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = atan2(x[i],y[i]);","var atan2 = Math.atan2;"),numeric.atan2VS=numeric.pointwise(["x[i]","y"],"ret[i] = atan2(x[i],y);","var atan2 = Math.atan2;"),numeric.atan2SV=numeric.pointwise(["x","y[i]"],"ret[i] = atan2(x,y[i]);","var atan2 = Math.atan2;"),numeric.atan2=function(b,c){return typeof b=="object"?typeof c=="object"?numeric.atan2VV(b,c):numeric.atan2VS(b,c):typeof c=="object"?numeric.atan2SV(b,c):Math.atan2(b,c)},numeric.powVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = pow(x[i],y[i]);","var pow = Math.pow;"),numeric.powVS=numeric.pointwise(["x[i]","y"],"ret[i] = pow(x[i],y);","var pow = Math.pow;"),numeric.powSV=numeric.pointwise(["x","y[i]"],"ret[i] = pow(x,y[i]);","var pow = Math.pow;"),numeric.pow=function(b,c){return typeof b=="object"?typeof c=="object"?numeric.powVV(b,c):numeric.powVS(b,c):typeof c=="object"?numeric.powSV(b,c):Math.pow(b,c)},numeric.clone=numeric.pointwise(["x[i]"],"ret[i] = x[i];"),numeric.inv=function(b){var c=numeric.dim(b),d=Math.abs;if(c.length!==2||c[0]!==c[1])throw new Error("numeric: inv() only works on square matrices");var e=c[0],f=numeric.identity(e),g,h,i,j=numeric.clone(b),k,l,m,n,o,p,q,r,s,t,u=numeric.linspace(0,e-1),v=numeric.rep([e],0);for(h=0;h<e-1;h++){i=h;for(g=h+1;g<e;g++)d(j[g][h])>d(j[i][h])&&(i=g);i!==h&&(p=j[i],j[i]=j[h],j[h]=p,p=f[i],f[i]=f[h],f[h]=p,p=u[i],u[i]=u[h],u[h]=p),k=j[h],m=f[h];for(g=h+1;g<e;g++){l=j[g],n=f[g],o=l[h]/k[h];if(o===0)continue;for(i=h+1;i<e-1;i+=2)r=i+1,l[i]-=k[i]*o,l[r]-=k[r]*o;i<e&&(l[i]-=k[i]*o);for(i=h;i>=1;i-=2)s=u[i-1],t=u[i],n[s]-=m[s]*o,n[t]-=m[t]*o;i>=0&&(n[u[i]]-=m[u[i]]*o)}}for(h=e-1;h>0;h--){k=j[h],m=f[h];for(g=0;g<h;g++){n=f[g],o=j[g][h]/k[h];if(o===0)continue;for(i=0;i<e-1;i+=2)r=i+1,n[i]-=m[i]*o,n[r]-=m[r]*o;i!==e&&(n[i]-=m[i]*o)}}for(g=0;g<e;g++){o=j[g][g];if(o===1)continue;n=f[g];for(h=0;h<e;h++)n[h]/=o}return f},numeric.det=function(b){var c=numeric.dim(b);if(c.length!==2||c[0]!==c[1])throw new Error("numeric: det() only works on square matrices");var d=c[0],e=1,f,g,h,i=numeric.clone(b),j,k,l,m,n,o,p;for(g=0;g<d-1;g++){h=g;for(f=g+1;f<d;f++)Math.abs(i[f][g])>Math.abs(i[h][g])&&(h=f);h!==g&&(m=i[h],i[h]=i[g],i[g]=m,e*=-1),j=i[g];for(f=g+1;f<d;f++){k=i[f],l=k[g]/j[g];for(h=g+1;h<d-1;h+=2)n=h+1,k[h]-=j[h]*l,k[n]-=j[n]*l;h!==d&&(k[h]-=j[h]*l)}if(j[g]===0)return 0;e*=j[g]}return e*i[g][g]},numeric.transpose=function(b){var c,d,e=b.length,f=b[0].length,g=Array(f),h,i,j;for(d=0;d<f;d++)g[d]=Array(e);for(c=e-1;c>=1;c-=2){i=b[c],h=b[c-1];for(d=f-1;d>=1;--d)j=g[d],j[c]=i[d],j[c-1]=h[d],--d,j=g[d],j[c]=i[d],j[c-1]=h[d];d===0&&(j=g[0],j[c]=i[0],j[c-1]=h[0])}if(c===0){h=b[0];for(d=f-1;d>=1;--d)g[d][0]=h[d],--d,g[d][0]=h[d];d===0&&(g[0][0]=h[0])}return g},numeric.negtranspose=function(b){var c,d,e=b.length,f=b[0].length,g=Array(f),h,i,j;for(d=0;d<f;d++)g[d]=Array(e);for(c=e-1;c>=1;c-=2){i=b[c],h=b[c-1];for(d=f-1;d>=1;--d)j=g[d],j[c]=-i[d],j[c-1]=-h[d],--d,j=g[d],j[c]=-i[d],j[c-1]=-h[d];d===0&&(j=g[0],j[c]=-i[0],j[c-1]=-h[0])}if(c===0){h=b[0];for(d=f-1;d>=1;--d)g[d][0]=-h[d],--d,g[d][0]=-h[d];d===0&&(g[0][0]=-h[0])}return g},numeric._random=function c(a,b){var d,e=a[b],f=Array(e),g;if(b===a.length-1){g=Math.random;for(d=e-1;d>=1;d-=2)f[d]=g(),f[d-1]=g();return d===0&&(f[0]=g()),f}for(d=e-1;d>=0;d--)f[d]=c(a,b+1);return f},numeric.random=function(b){return numeric._random(b,0)},numeric.norm2Squared=function(b){},numeric.norm2Squared=numeric.mapreduce("accum += xi*xi;","0"),numeric.norm2=function(b){return Math.sqrt(numeric.norm2Squared(b))},numeric.norminf=numeric.mapreduce("accum = max(abs(xi),accum);","0; var max = Math.max, abs = Math.abs;"),numeric.sum=numeric.mapreduce("accum += xi;","0"),numeric.linspace=function(b,c,d){typeof d=="undefined"&&(d=Math.round(c-b)+1);var e,f=Array(d);d--;for(e=d;e>=0;e--)f[e]=(e*c+(d-e)*b)/d;return f},numeric.getBlock=function(b,c,d){function f(a,b){var g,h=c[b],i=d[b]-h,j=Array(i);if(b===e.length-1){for(g=i;g>=0;g--)j[g]=a[g+h];return j}for(g=i;g>=0;g--)j[g]=f(a[g+h],b+1);return j}var e=numeric.dim(b);return f(b,0)},numeric.setBlock=function(b,c,d,e){function g(a,b,e){var h,i=c[e],j=d[e]-i;if(e===f.length-1)for(h=j;h>=0;h--)a[h+i]=b[h];for(h=j;h>=0;h--)g(a[h+i],b[h],e+1)}var f=numeric.dim(b);return g(b,e,0),b},numeric.tensor=function(b,c){if(typeof b=="number"||typeof c=="number")return numeric.mul(b,c);var d=numeric.dim(b),e=numeric.dim(c);if(d.length!==1||e.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var f=d[0],g=e[0],h=Array(f),i,j,k,l;for(j=f-1;j>=0;j--){i=Array(g),l=b[j];for(k=g-1;k>=3;--k)i[k]=l*c[k],--k,i[k]=l*c[k],--k,i[k]=l*c[k],--k,i[k]=l*c[k];while(k>=0)i[k]=l*c[k],--k;h[j]=i}return h},numeric.T=function(b,c){this.x=b,this.y=c},numeric.t=function(b,c){return new numeric.T(b,c)},numeric.Tbinop=function(b,c,d,e,f){var g=numeric.indexOf;if(typeof f!="string"){var h;f="";for(h in numeric)numeric.hasOwnProperty(h)&&(b.indexOf(h)>=0||c.indexOf(h)>=0||d.indexOf(h)>=0||e.indexOf(h)>=0)&&h.length>1&&(f+="var "+h+" = numeric."+h+";\n")}return numeric.Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+f+"\n"+"if(x.y) {"+"  if(y.y) {"+"    return new numeric.T("+e+");\n"+"  }\n"+"  return new numeric.T("+d+");\n"+"}\n"+"if(y.y) {\n"+"  return new numeric.T("+c+");\n"+"}\n"+"return new numeric.T("+b+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var b=numeric.mul,c=numeric.div;if(this.y){var d=numeric.add(b(this.x,this.x),b(this.y,this.y));return new numeric.T(c(this.x,d),c(numeric.neg(this.y),d))}return new T(c(1,this.x))},numeric.T.prototype.div=function d(a){a instanceof numeric.T||(a=new numeric.T(a));if(a.y)return this.mul(a.reciprocal());var d=numeric.div;return this.y?new numeric.T(d(this.x,a.x),d(this.y,a.x)):new numeric.T(d(this.x,a.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var b=numeric.transpose,c=this.x,d=this.y;return d?new numeric.T(b(c),b(d)):new numeric.T(b(c))},numeric.T.prototype.transjugate=function(){var b=numeric.transpose,c=this.x,d=this.y;return d?new numeric.T(b(c),numeric.negtranspose(d)):new numeric.T(b(c))},numeric.Tunop=function(b,c,d){return typeof d!="string"&&(d=""),numeric.Function("var x = this;\n"+d+"\n"+"if(x.y) {"+"  "+c+";\n"+"}\n"+b+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var b=this;if(typeof b.y=="undefined")return new numeric.T(numeric.inv(b.x));var c=b.x.length,d,e,f,g=numeric.identity(c),h=numeric.rep([c,c],0),i=numeric.clone(b.x),j=numeric.clone(b.y),k,l,m,n,o,p,q,r,d,e,f,s,t,u,v,w,x,y;for(d=0;d<c;d++){u=i[d][d],v=j[d][d],s=u*u+v*v,f=d;for(e=d+1;e<c;e++)u=i[e][d],v=j[e][d],t=u*u+v*v,t>s&&(f=e,s=t);f!==d&&(y=i[d],i[d]=i[f],i[f]=y,y=j[d],j[d]=j[f],j[f]=y,y=g[d],g[d]=g[f],g[f]=y,y=h[d],h[d]=h[f],h[f]=y),k=i[d],l=j[d],o=g[d],p=h[d],u=k[d],v=l[d];for(e=d+1;e<c;e++)w=k[e],x=l[e],k[e]=(w*u+x*v)/s,l[e]=(x*u-w*v)/s;for(e=0;e<c;e++)w=o[e],x=p[e],o[e]=(w*u+x*v)/s,p[e]=(x*u-w*v)/s;for(e=d+1;e<c;e++){m=i[e],n=j[e],q=g[e],r=h[e],u=m[d],v=n[d];for(f=d+1;f<c;f++)w=k[f],x=l[f],m[f]-=w*u-x*v,n[f]-=x*u+w*v;for(f=0;f<c;f++)w=o[f],x=p[f],q[f]-=w*u-x*v,r[f]-=x*u+w*v}}for(d=c-1;d>0;d--){o=g[d],p=h[d];for(e=d-1;e>=0;e--){q=g[e],r=h[e],u=i[e][d],v=j[e][d];for(f=c-1;f>=0;f--)w=o[f],x=p[f],q[f]-=u*w-v*x,r[f]-=u*x+v*w}}return new numeric.T(g,h)},numeric.T.prototype.get=function(b){var c=this.x,d=this.y,e=0,f,g=b.length;if(d){while(e<g)f=b[e],c=c[f],d=d[f],e++;return new numeric.T(c,d)}while(e<g)f=b[e],c=c[f],e++;return new numeric.T(c)},numeric.T.prototype.set=function(b,c){var d=this.x,e=this.y,f=0,g,h=b.length,i=c.x,j=c.y;if(h===0)return j?this.y=j:e&&(this.y=undefined),this.x=d,this;if(j){e||(e=numeric.rep(numeric.dim(d),0),this.y=e);while(f<h-1)g=b[f],d=d[g],e=e[g],f++;return g=b[f],d[g]=i,e[g]=j,this}if(e){while(f<h-1)g=b[f],d=d[g],e=e[g],f++;return g=b[f],d[g]=i,i instanceof Array?e[g]=numeric.rep(numeric.dim(i),0):e[g]=0,this}while(f<h-1)g=b[f],d=d[g],f++;return g=b[f],d[g]=i,this},numeric.T.prototype.getRows=function(b,c){var d=c-b+1,e,f=Array(d),g,h=this.x,i=this.y;for(e=b;e<=c;e++)f[e-b]=h[e];if(i){g=Array(d);for(e=b;e<=c;e++)g[e-b]=i[e];return new numeric.T(f,g)}return new numeric.T(f)},numeric.T.prototype.setRows=function(b,c,d){var e,f=this.x,g=this.y,h=d.x,i=d.y;for(e=b;e<=c;e++)f[e]=h[e-b];if(i){g||(g=numeric.rep(numeric.dim(f),0),this.y=g);for(e=b;e<=c;e++)g[e]=i[e-b]}else if(g)for(e=b;e<=c;e++)g[e]=numeric.rep([h[e-b].length],0);return this},numeric.T.prototype.getRow=function(b){var c=this.x,d=this.y;return d?new numeric.T(c[b],d[b]):new numeric.T(c[b])},numeric.T.prototype.setRow=function(b,c){var d=this.x,e=this.y,f=c.x,g=c.y;return d[b]=f,g?(e||(e=numeric.rep(numeric.dim(d),0),this.y=e),e[b]=g):e&&(e=numeric.rep([f.length],0)),this},numeric.T.prototype.getBlock=function(b,c){var d=this.x,e=this.y,f=numeric.getBlock;return e?new numeric.T(f(d,b,c),f(e,b,c)):new numeric.T(f(d,b,c))},numeric.T.prototype.setBlock=function(b,c,d){d instanceof numeric.T||(d=new numeric.T(d));var e=this.x,f=this.y,g=numeric.setBlock,h=d.x,i=d.y;if(i)return f||(this.y=numeric.rep(numeric.dim(this),0),f=this.y),g(e,b,c,h),g(f,b,c,i),this;g(e,b,c,h),f&&g(f,b,c,numeric.rep(numeric.dim(h),0))},numeric.T.rep=function(b,c){var d=numeric.T;c instanceof d||(c=new d(c));var e=c.x,f=c.y,g=numeric.rep;return f?new d(g(b,e),g(b,f)):new d(g(b,e))},numeric.T.diag=function e(a){a instanceof numeric.T||(a=new numeric.T(a));var b=a.x,c=a.y,e=numeric.diag;return c?new numeric.T(e(b),e(c)):new numeric.T(e(b))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(b){return new numeric.T(numeric.identity(b))},numeric.T.prototype.getDiag=function(){var b=numeric,c=this.x,d=this.y;return d?new b.T(b.getDiag(c),b.getDiag(d)):new b.T(b.getDiag(c))},numeric.house=function(b){var c=numeric.clone(b),d=b[0]>=0?1:-1,e=d*numeric.norm2(b);c[0]+=e;var f=numeric.norm2(c);if(f===0)throw new Error("eig: internal error");return numeric.div(c,f)},numeric.toUpperHessenberg=function(b){var c=numeric.dim(b);if(c.length!==2||c[0]!==c[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var d=c[0],e,f,g,h,i,j=numeric.clone(b),k,l,m,n,o=numeric.identity(d),p;for(f=0;f<d-2;f++){h=Array(d-f-1);for(e=f+1;e<d;e++)h[e-f-1]=j[e][f];i=numeric.house(h),k=numeric.getBlock(j,[f+1,f],[d-1,d-1]),l=numeric.tensor(i,numeric.dot(i,k));for(e=f+1;e<d;e++){m=j[e],n=l[e-f-1];for(g=f;g<d;g++)m[g]-=2*n[g-f]}k=numeric.getBlock(j,[0,f+1],[d-1,d-1]),l=numeric.tensor(numeric.dot(k,i),i);for(e=0;e<d;e++){m=j[e],n=l[e];for(g=f+1;g<d;g++)m[g]-=2*n[g-f-1]}k=Array(d-f-1);for(e=f+1;e<d;e++)k[e-f-1]=o[e];l=numeric.tensor(i,numeric.dot(i,k));for(e=f+1;e<d;e++){p=o[e],n=l[e-f-1];for(g=0;g<d;g++)p[g]-=2*n[g]}}return{H:j,Q:o}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(a,b){typeof b=="undefined"&&(b=1e4),a=numeric.clone(a);var c=numeric.clone(a),d=numeric.dim(a),e=d[0],f,g,h,i,j,k,l,m,n,o=numeric.identity(e),p,q,r,s,t,u,v,w,x;if(e<3)return{Q:o,B:[[0,e-1]]};var y=numeric.epsilon;for(x=0;x<b;x++){for(v=0;v<e-1;v++)if(Math.abs(a[v+1][v])<y*(Math.abs(a[v][v])+Math.abs(a[v+1][v+1]))){var z=numeric.QRFrancis(numeric.getBlock(a,[0,0],[v,v]),b),A=numeric.QRFrancis(numeric.getBlock(a,[v+1,v+1],[e-1,e-1]),b);r=Array(v+1);for(u=0;u<=v;u++)r[u]=o[u];s=numeric.dot(z.Q,r);for(u=0;u<=v;u++)o[u]=s[u];r=Array(e-v-1);for(u=v+1;u<e;u++)r[u-v-1]=o[u];s=numeric.dot(A.Q,r);for(u=v+1;u<e;u++)o[u]=s[u-v-1];return{Q:o,B:z.B.concat(numeric.add(A.B,v+1))}}h=a[e-2][e-2],i=a[e-2][e-1],j=a[e-1][e-2],k=a[e-1][e-1],m=h+k,l=h*k-i*j,n=numeric.getBlock(a,[0,0],[2,2]);if(m*m>=4*l){var B,C;B=.5*(m+Math.sqrt(m*m-4*l)),C=.5*(m-Math.sqrt(m*m-4*l)),n=numeric.add(numeric.sub(numeric.dot(n,n),numeric.mul(n,B+C)),numeric.diag(numeric.rep([3],B*C)))}else n=numeric.add(numeric.sub(numeric.dot(n,n),numeric.mul(n,m)),numeric.diag(numeric.rep([3],l)));f=[n[0][0],n[1][0],n[2][0]],g=numeric.house(f),r=[a[0],a[1],a[2]],s=numeric.tensor(g,numeric.dot(g,r));for(u=0;u<3;u++){q=a[u],t=s[u];for(w=0;w<e;w++)q[w]-=2*t[w]}r=numeric.getBlock(a,[0,0],[e-1,2]),s=numeric.tensor(numeric.dot(r,g),g);for(u=0;u<e;u++){q=a[u],t=s[u];for(w=0;w<3;w++)q[w]-=2*t[w]}r=[o[0],o[1],o[2]],s=numeric.tensor(g,numeric.dot(g,r));for(u=0;u<3;u++){p=o[u],t=s[u];for(w=0;w<e;w++)p[w]-=2*t[w]}var D;for(v=0;v<e-2;v++){for(w=v;w<=v+1;w++)if(Math.abs(a[w+1][w])<y*(Math.abs(a[w][w])+Math.abs(a[w+1][w+1]))){var z=numeric.QRFrancis(numeric.getBlock(a,[0,0],[w,w]),b),A=numeric.QRFrancis(numeric.getBlock(a,[w+1,w+1],[e-1,e-1]),b);r=Array(w+1);for(u=0;u<=w;u++)r[u]=o[u];s=numeric.dot(z.Q,r);for(u=0;u<=w;u++)o[u]=s[u];r=Array(e-w-1);for(u=w+1;u<e;u++)r[u-w-1]=o[u];s=numeric.dot(A.Q,r);for(u=w+1;u<e;u++)o[u]=s[u-w-1];return{Q:o,B:z.B.concat(numeric.add(A.B,w+1))}}D=Math.min(e-1,v+3),f=Array(D-v);for(u=v+1;u<=D;u++)f[u-v-1]=a[u][v];g=numeric.house(f),r=numeric.getBlock(a,[v+1,v],[D,e-1]),s=numeric.tensor(g,numeric.dot(g,r));for(u=v+1;u<=D;u++){q=a[u],t=s[u-v-1];for(w=v;w<e;w++)q[w]-=2*t[w-v]}r=numeric.getBlock(a,[0,v+1],[e-1,D]),s=numeric.tensor(numeric.dot(r,g),g);for(u=0;u<e;u++){q=a[u],t=s[u];for(w=v+1;w<=D;w++)q[w]-=2*t[w-v-1]}r=Array(D-v);for(u=v+1;u<=D;u++)r[u-v-1]=o[u];s=numeric.tensor(g,numeric.dot(g,r));for(u=v+1;u<=D;u++){p=o[u],t=s[u-v-1];for(w=0;w<e;w++)p[w]-=2*t[w]}}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(b,c){var d=numeric.toUpperHessenberg(b),e=numeric.QRFrancis(d.H,c),f=numeric.T,g=b.length,h,i,j=!1,k=e.B,l=numeric.dot(e.Q,numeric.dot(d.H,numeric.transpose(e.Q))),m=new f(numeric.dot(e.Q,d.Q)),n,o=k.length,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=Math.sqrt;for(i=0;i<o;i++){h=k[i][0];if(h!==k[i][1]){p=h+1,q=l[h][h],r=l[h][p],s=l[p][h],t=l[p][p];if(r===0&&s===0)continue;u=-q-t,v=q*t-r*s,w=u*u-4*v,w>=0?(u<0?x=-0.5*(u-D(w)):x=-0.5*(u+D(w)),B=(q-x)*(q-x)+r*r,C=s*s+(t-x)*(t-x),B>C?(B=D(B),z=(q-x)/B,A=r/B):(C=D(C),z=s/C,A=(t-x)/C),n=new f([[A,-z],[z,A]]),m.setRows(h,p,n.dot(m.getRows(h,p)))):(x=-0.5*u,y=.5*D(-w),B=(q-x)*(q-x)+r*r,C=s*s+(t-x)*(t-x),B>C?(B=D(B+y*y),z=(q-x)/B,A=r/B,x=0,y/=B):(C=D(C+y*y),z=s/C,A=(t-x)/C,x=y/C,y=0),n=new f([[A,-z],[z,A]],[[x,y],[y,-x]]),m.setRows(h,p,n.dot(m.getRows(h,p))))}}var E=m.dot(b).dot(m.transjugate()),g=b.length,F=numeric.T.identity(g);for(p=0;p<g;p++)if(p>0)for(i=p-1;i>=0;i--){var G=E.get([i,i]),H=E.get([p,p]);if(!numeric.neq(G.x,H.x)&&!numeric.neq(G.y,H.y)){F.setRow(p,F.getRow(i));continue}x=E.getRow(i).getBlock([i],[p-1]),y=F.getRow(p).getBlock([i],[p-1]),F.set([p,i],E.get([i,p]).neg().sub(x.dot(y)).div(G.sub(H)))}for(p=0;p<g;p++)x=F.getRow(p),F.setRow(p,x.div(x.norm2()));return F=F.transpose(),F=m.transjugate().dot(F),{lambda:E.getDiag(),E:F}},numeric.sdim=function f(a,b,c){typeof b=="undefined"&&(b=[]);if(typeof a!="object")return b;typeof c=="undefined"&&(c=0),c in b||(b[c]=0),a.length>b[c]&&(b[c]=a.length);var d;for(d in a)a.hasOwnProperty(d)&&f(a[d],b,c+1);return b},numeric.sclone=function g(a,b,c){typeof b=="undefined"&&(b=0),typeof c=="undefined"&&(c=numeric.sdim(a).length);var d,e=Array(a.length);if(b===c-1){for(d in a)a.hasOwnProperty(d)&&(e[d]=a[d]);return e}for(d in a)a.hasOwnProperty(d)&&(e[d]=g(a[d],b+1,c));return e},numeric.sdiag=function(b){var c=b.length,d,e=Array(c),f,g,h;for(d=c-1;d>=1;d-=2)f=d-1,e[d]=[],e[d][d]=b[d],e[f]=[],e[f][f]=b[f];return d===0&&(e[0]=[],e[0][0]=b[d]),e},numeric.sidentity=function(b){return numeric.sdiag(numeric.rep([b],1))},numeric.stranspose=function(b){var c=[],d=b.length,e,f,g;for(e in b){if(!b.hasOwnProperty(e))continue;g=b[e];for(f in g){if(!g.hasOwnProperty(f))continue;typeof c[f]!="object"&&(c[f]=[]),c[f][e]=g[f]}}return c},numeric.sLUP=function(b,c){typeof c=="undefined"&&(c=1);var d=b.length,e,f,g,h=numeric.sidentity(d),i=numeric.sclone(b),j=numeric.stranspose(i),k=numeric.linspace(0,d-1),l=numeric.linspace(0,d-1),m,n,o,p,q,r=Math.abs;for(e=0;e<d-1;e++){o=j[e],f=e;for(g in o){if(!l.hasOwnProperty(g))continue;g=l[g];if(g<=e)continue;r(i[g][e])>r(i[f][e])&&(f=g)}r(i[e][e])>=c*r(i[f][e])&&(f=e);if(f!==e){p=i[e],i[e]=i[f],i[f]=p,p=h[e],h[e]=h[f],h[f]=p,p=k[e],k[e]=k[f],k[f]=p,l=Array(d);for(f=0;f<d;f++)l[k[f]]=f}m=i[e];for(f in o){if(!l.hasOwnProperty(f))continue;f=l[f];if(f<=e)continue;n=i[f],q=n[e]/m[e],h[f][e]=q;for(g in m){if(!m.hasOwnProperty(g))continue;g>e?(g in n||(n[g]=0,j[g][f]=0),n[g]-=q*m[g]):delete n[g]}}}return{L:h,U:i,P:k,Pinv:l}},numeric.sdotMM=function(b,c){var d=b.length,e=c.length,f=numeric.stranspose(c),g=f.length,h,i,j,k,l,m,n=Array(d),o;for(j=d-1;j>=0;j--){o=[],h=b[j];for(l=g-1;l>=0;l--)
{m=0,i=f[l];for(k in h){if(!h.hasOwnProperty(k))continue;k in i&&(m+=h[k]*i[k])}m&&(o[l]=m)}n[j]=o}return n},numeric.sdotMV=function(b,c){var d=b.length,e,f,g,h=Array(d),i;for(f=d-1;f>=0;f--){e=b[f],i=0;for(g in e){if(!e.hasOwnProperty(g))continue;c[g]&&(i+=e[g]*c[g])}i&&(h[f]=i)}return h},numeric.sdotVM=function(b,c){var d,e,f,g,h=[],i;for(d in b){if(!b.hasOwnProperty(d))continue;f=c[d],g=b[d];for(e in f){if(!f.hasOwnProperty(e))continue;h[e]||(h[e]=0),h[e]+=g*f[e]}}return h},numeric.sdotVV=function(b,c){var d,e=0;for(d in b)b[d]&&c[d]&&(e+=b[d]*c[d]);return e},numeric.sdot=function(b,c){var d=numeric.sdim(b).length,e=numeric.sdim(c).length,f=d*1e3+e;switch(f){case 0:return b*c;case 1001:return numeric.sdotVV(b,c);case 2001:return numeric.sdotMV(b,c);case 1002:return numeric.sdotVM(b,c);case 2002:return numeric.sdotMM(b,c);default:throw new Error("numeric.sdot not implemented for tensors of order "+d+" and "+e)}},numeric.sLUPsolve=function(b,c){var d=b.L,e=b.U,f=b.P,g=d.length,h,i,j=Array(g),k,l,m;for(h=0;h<g;h++){c.hasOwnProperty(f[h])?k=c[f[h]]:k=0,l=d[h];for(i in l){if(!l.hasOwnProperty(i))continue;i<h&&(k-=l[i]*j[i])}j[h]=k}for(h=g-1;h>=0;h--){k=j[h],l=e[h];for(i in l){if(!l.hasOwnProperty(i))continue;i>h&&(k-=l[i]*j[i])}j[h]=k/l[h]}return j},numeric.sscatter=function(b){var c=b[0].length,d,e,f,g=b.length,h=[],i;for(e=c-1;e>=0;--e){if(!b[g-1][e])continue;i=h;for(f=0;f<g-2;f++)d=b[f][e],i[d]||(i[d]=[]),i=i[d];i[b[f][e]]=b[f+1][e]}return h},numeric.sgather=function h(a,b,c){typeof b=="undefined"&&(b=[]),typeof c=="undefined"&&(c=[]);var d,e,f;d=c.length;for(e in a)if(a.hasOwnProperty(e)){c[d]=parseInt(e),f=a[e];if(typeof f=="number"){if(f){if(b.length===0)for(e=d+1;e>=0;--e)b[e]=[];for(e=d;e>=0;--e)b[e].push(c[e]);b[d+1].push(f)}}else h(f,b,c)}return c.length>d&&c.pop(),b},numeric.cLU=function(b){var c=b[0],d=b[1],e=b[2],f=c.length,g=0,h,i,j,k,l,m;for(h=0;h<f;h++)c[h]>g&&(g=c[h]);g++;var n=Array(g),o=Array(g),p=numeric.rep([g],Infinity),q=numeric.rep([g],-Infinity),r,s,t;for(j=0;j<f;j++)h=c[j],i=d[j],i<p[h]&&(p[h]=i),i>q[h]&&(q[h]=i);for(h=0;h<g-1;h++)q[h]>q[h+1]&&(q[h+1]=q[h]);for(h=g-1;h>=1;h--)p[h]<p[h-1]&&(p[h-1]=p[h]);var u=0,v=0;for(h=0;h<g;h++)o[h]=numeric.rep([q[h]-p[h]+1],0),n[h]=numeric.rep([h-p[h]],0),u+=h-p[h]+1,v+=q[h]-h+1;for(j=0;j<f;j++)h=c[j],o[h][d[j]-p[h]]=e[j];for(h=0;h<g-1;h++){k=h-p[h],r=o[h];for(i=h+1;p[i]<=h&&i<g;i++){l=h-p[i],m=q[h]-h,s=o[i],t=s[l]/r[k];if(t){for(j=1;j<=m;j++)s[j+l]-=t*r[j+k];n[i][h-p[i]]=t}}}var r=[],s=[],w=[],x=[],y=[],z=[],f,A,B;f=0,A=0;for(h=0;h<g;h++){k=p[h],l=q[h],B=o[h];for(i=h;i<=l;i++)B[i-k]&&(r[f]=h,s[f]=i,w[f]=B[i-k],f++);B=n[h];for(i=k;i<h;i++)B[i-k]&&(x[A]=h,y[A]=i,z[A]=B[i-k],A++);x[A]=h,y[A]=h,z[A]=1,A++}return{U:[r,s,w],L:[x,y,z]}},numeric.cLUsolve=function(b,c){var d=b.L,e=b.U,f=numeric.clone(c),g=d[0],h=d[1],i=d[2],j=e[0],k=e[1],l=e[2],m=j.length,n=g.length,o=f.length,p,q,r;r=0;for(p=0;p<o;p++){while(h[r]<p)f[p]-=i[r]*f[h[r]],r++;r++}r=m-1;for(p=o-1;p>=0;p--){while(k[r]>p)f[p]-=l[r]*f[k[r]],r--;f[p]/=l[r],r--}return f},numeric.cgrid=function(b,c){typeof b=="number"&&(b=[b,b]);var d=numeric.rep(b,-1),e,f,g;if(typeof c!="function")switch(c){case"L":c=function(a,c){return a>=b[0]/2||c<b[1]/2};break;default:c=function(a,b){return!0}}g=0;for(e=1;e<b[0]-1;e++)for(f=1;f<b[1]-1;f++)c(e,f)&&(d[e][f]=g,g++);return d},numeric.cdelsq=function(b){var c=[[-1,0],[0,-1],[0,1],[1,0]],d=numeric.dim(b),e=d[0],f=d[1],g,h,i,j,k,l=[],m=[],n=[];for(g=1;g<e-1;g++)for(h=1;h<f-1;h++){if(b[g][h]<0)continue;for(i=0;i<4;i++){j=g+c[i][0],k=h+c[i][1];if(b[j][k]<0)continue;l.push(b[g][h]),m.push(b[j][k]),n.push(-1)}l.push(b[g][h]),m.push(b[g][h]),n.push(4)}return[l,m,n]},numeric.cdotMV=function(b,c){var d,e=b[0],f=b[1],g=b[2],h,i=e.length,j;j=0;for(h=0;h<i;h++)e[h]>j&&(j=e[h]);j++,d=numeric.rep([j],0);for(h=0;h<i;h++)d[e[h]]+=g[h]*c[f[h]];return d},numeric.Spline=function(b,c,d,e,f){this.x=b,this.yl=c,this.yr=d,this.kl=e,this.kr=f},numeric.Spline.prototype._at=function(b,c){var d=this.x,e=this.yl,f=this.yr,g=this.kl,h=this.kr,b,i,j,k,l=numeric.add,m=numeric.sub,n=numeric.mul;i=m(n(g[c],d[c+1]-d[c]),m(f[c+1],e[c])),j=l(n(h[c+1],d[c]-d[c+1]),m(f[c+1],e[c])),k=(b-d[c])/(d[c+1]-d[c]);var o=k*(1-k);return l(l(l(n(1-k,e[c]),n(k,f[c+1])),n(i,o*(1-k))),n(j,o*k))},numeric.Spline.prototype.at=function(b){if(typeof b=="number"){var c=this.x,d=c.length,e,f,g,h=Math.floor,i,j,k;e=0,f=d-1;while(f-e>1)g=h((e+f)/2),c[g]<=b?e=g:f=g;return this._at(b,e)}var d=b.length,l,m=Array(d);for(l=d-1;l!==-1;--l)m[l]=this.at(b[l]);return m},numeric.Spline.prototype.diff=function(){var b=this.x,c=this.yl,d=this.yr,e=this.kl,f=this.kr,g=c.length,h,i,j,k=e,l=f,m=Array(g),n=Array(g),o=numeric.add,p=numeric.mul,q=numeric.div,r=numeric.sub;for(h=g-1;h!==-1;--h)i=b[h+1]-b[h],j=r(d[h+1],c[h]),m[h]=q(o(p(j,6),p(e[h],-4*i),p(f[h+1],-2*i)),i*i),n[h+1]=q(o(p(j,-6),p(e[h],2*i),p(f[h+1],4*i)),i*i);return new numeric.Spline(b,k,l,m,n)},numeric.Spline.prototype.roots=function(){function b(a){return a*a}function c(a,b,c,d,e){var f=c*2-(b-a),g=-d*2+(b-a),h=(e+1)*.5,i=h*(1-h);return(1-h)*a+h*b+f*i*(1-h)+g*i*h}var d=[],e=this.x,f=this.yl,g=this.yr,h=this.kl,i=this.kr;typeof f[0]=="number"&&(f=[f],g=[g],h=[h],i=[i]);var j=f.length,k=e.length-1,l,m,n,o,p,q,r,s,t,u,d=Array(j),v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=Math.sqrt;for(l=0;l!==j;++l){r=f[l],s=g[l],t=h[l],u=i[l],v=[];for(m=0;m!==k;m++){m>0&&s[m]*r[m]<0&&v.push(e[m]),D=e[m+1]-e[m],E=e[m],y=r[m],z=s[m+1],w=t[m]/D,x=u[m+1]/D,C=b(w-x+3*(y-z))+12*x*y,A=x+3*y+2*w-3*z,B=3*(x+w+2*(y-z)),C<=0?(G=A/B,G>e[m]&&G<e[m+1]?F=[e[m],G,e[m+1]]:F=[e[m],e[m+1]]):(G=(A-M(C))/B,H=(A+M(C))/B,F=[e[m]],G>e[m]&&G<e[m+1]&&F.push(G),H>e[m]&&H<e[m+1]&&F.push(H),F.push(e[m+1])),J=F[0],G=this._at(J,m);for(n=0;n<F.length-1;n++){K=F[n+1],H=this._at(K,m);if(G===0){v.push(J),J=K,G=H;continue}if(H===0||G*H>0){J=K,G=H;continue}var N=0;for(;;){L=(G*K-H*J)/(G-H);if(L<=J||L>=K)break;I=this._at(L,m);if(I*H>0)K=L,H=I,N===-1&&(G*=.5),N=-1;else{if(!(I*G>0))break;J=L,G=I,N===1&&(H*=.5),N=1}}v.push(L),J=F[n+1],G=this._at(J,m)}H===0&&v.push(K)}d[l]=v}return typeof this.yl[0]=="number"?d[0]:d},numeric.spline=function(b,c,d,e){var f=b.length,g=[],h=[],i=[],j,k=numeric.sub,l=numeric.mul,m=numeric.add;for(j=f-2;j>=0;j--)h[j]=b[j+1]-b[j],i[j]=k(c[j+1],c[j]);if(typeof d=="string"||typeof e=="string")d=e="periodic";var n=[[],[],[]];switch(typeof d){case"undefined":g[0]=l(3/(h[0]*h[0]),i[0]),n[0].push(0,0),n[1].push(0,1),n[2].push(2/h[0],1/h[0]);break;case"string":g[0]=m(l(3/(h[f-2]*h[f-2]),i[f-2]),l(3/(h[0]*h[0]),i[0])),n[0].push(0,0,0),n[1].push(f-2,0,1),n[2].push(1/h[f-2],2/h[f-2]+2/h[0],1/h[0]);break;default:g[0]=d,n[0].push(0),n[1].push(0),n[2].push(1)}for(j=1;j<f-1;j++)g[j]=m(l(3/(h[j-1]*h[j-1]),i[j-1]),l(3/(h[j]*h[j]),i[j])),n[0].push(j,j,j),n[1].push(j-1,j,j+1),n[2].push(1/h[j-1],2/h[j-1]+2/h[j],1/h[j]);switch(typeof e){case"undefined":g[f-1]=l(3/(h[f-2]*h[f-2]),i[f-2]),n[0].push(f-1,f-1),n[1].push(f-2,f-1),n[2].push(1/h[f-2],2/h[f-2]);break;case"string":n[1][n[1].length-1]=0;break;default:g[f-1]=e,n[0].push(f-1),n[1].push(f-1),n[2].push(1)}typeof g[0]!="number"?g=numeric.transpose(g):g=[g];var o=Array(g.length);if(typeof d=="string")for(j=o.length-1;j!==-1;--j)o[j]=numeric.sLUPsolve(numeric.sLUP(numeric.sscatter(n)),g[j]),o[j][f-1]=o[j][0];else for(j=o.length-1;j!==-1;--j)o[j]=numeric.cLUsolve(numeric.cLU(n),g[j]);return typeof c[0]=="number"?o=o[0]:o=numeric.transpose(o),new numeric.Spline(b,c,c,o,o)},numeric.fftpow2=function i(a,b){var c=a.length;if(c===1)return;var d=Math.cos,e=Math.sin,f,g,h=Array(c/2),j=Array(c/2),k=Array(c/2),l=Array(c/2);g=c/2;for(f=c-1;f!==-1;--f)--g,k[g]=a[f],l[g]=b[f],--f,h[g]=a[f],j[g]=b[f];i(h,j),i(k,l),g=c/2;var m,n=-6.283185307179586/c,o,p;for(f=c-1;f!==-1;--f)--g,g===-1&&(g=c/2-1),m=n*f,o=d(m),p=e(m),a[f]=h[g]+o*k[g]-p*l[g],b[f]=j[g]+o*l[g]+p*k[g]},numeric._ifftpow2=function j(a,b){var c=a.length;if(c===1)return;var d=Math.cos,e=Math.sin,f,g,h=Array(c/2),i=Array(c/2),k=Array(c/2),l=Array(c/2);g=c/2;for(f=c-1;f!==-1;--f)--g,k[g]=a[f],l[g]=b[f],--f,h[g]=a[f],i[g]=b[f];j(h,i),j(k,l),g=c/2;var m,n=6.283185307179586/c,o,p;for(f=c-1;f!==-1;--f)--g,g===-1&&(g=c/2-1),m=n*f,o=d(m),p=e(m),a[f]=h[g]+o*k[g]-p*l[g],b[f]=i[g]+o*l[g]+p*k[g]},numeric.ifftpow2=function(b,c){numeric._ifftpow2(b,c),numeric.diveq(b,b.length),numeric.diveq(c,c.length)},numeric.convpow2=function(b,c,d,e){numeric.fftpow2(b,c),numeric.fftpow2(d,e);var f,g=b.length,h,i,j,k;for(f=g-1;f!==-1;--f)h=b[f],j=c[f],i=d[f],k=e[f],b[f]=h*i-j*k,c[f]=h*k+j*i;numeric.ifftpow2(b,c)},numeric.T.prototype.fft=function(){var b=this.x,c=this.y,d=b.length,e=Math.log,f=e(2),g=Math.ceil(e(2*d-1)/f),h=Math.pow(2,g),i=numeric.rep([h],0),j=numeric.rep([h],0),k=Math.cos,l=Math.sin,m,n=-3.141592653589793/d,o,p=numeric.rep([h],0),q=numeric.rep([h],0),r=Math.floor(d/2);for(m=0;m<d;m++)p[m]=b[m];if(typeof c!="undefined")for(m=0;m<d;m++)q[m]=c[m];i[0]=1;for(m=1;m<=h/2;m++)o=n*m*m,i[m]=k(o),j[m]=l(o),i[h-m]=k(o),j[h-m]=l(o);var s=new numeric.T(p,q),t=new numeric.T(i,j);return s=s.mul(t),numeric.convpow2(s.x,s.y,numeric.clone(t.x),numeric.neg(t.y)),s=s.mul(t),s.x.length=d,s.y.length=d,s},numeric.T.prototype.ifft=function(){var b=this.x,c=this.y,d=b.length,e=Math.log,f=e(2),g=Math.ceil(e(2*d-1)/f),h=Math.pow(2,g),i=numeric.rep([h],0),j=numeric.rep([h],0),k=Math.cos,l=Math.sin,m,n=3.141592653589793/d,o,p=numeric.rep([h],0),q=numeric.rep([h],0),r=Math.floor(d/2);for(m=0;m<d;m++)p[m]=b[m];if(typeof c!="undefined")for(m=0;m<d;m++)q[m]=c[m];i[0]=1;for(m=1;m<=h/2;m++)o=n*m*m,i[m]=k(o),j[m]=l(o),i[h-m]=k(o),j[h-m]=l(o);var s=new numeric.T(p,q),t=new numeric.T(i,j);return s=s.mul(t),numeric.convpow2(s.x,s.y,numeric.clone(t.x),numeric.neg(t.y)),s=s.mul(t),s.x.length=d,s.y.length=d,s.div(d)},numeric.gradient=function(b,c){var d=c.length,e=b(c),f=Math.max,g,h=numeric.clone(c),i,j,k=Array(d),l=numeric.div,m=numeric.sub,n,o,f=Math.max,p=.001,q=Math.abs,r=Math.min,s,t,u,v=0,w,x,y;for(g=0;g<d;g++){var z=f(1e-6*e,1e-8);for(;;){++v;if(v>20)throw new Error("Numerical gradient fails");h[g]=c[g]+z,i=b(h),h[g]=c[g]-z,j=b(h),h[g]=c[g],k[g]=(i-j)/(2*z),s=c[g]-z,t=c[g],u=c[g]+z,w=(i-e)/z,x=(e-j)/z,y=f(q(k[g]),q(e),q(i),q(j),q(s),q(t),q(u),1e-8),n=r(f(q(w-k[g]),q(x-k[g]),q(w-x))/y,z/y);if(!(n>p))break;z/=16}}return k},numeric.uncmin=function(b,c,d,e,f,g){var h=numeric.gradient;typeof d=="undefined"&&(d=1e-8),typeof e=="undefined"&&(e=function(a){return h(b,a)}),typeof f=="undefined"&&(f=1e3),c=numeric.clone(c);var i=c.length,j=b(c),k,l,m=Math.max,n=numeric.norm2;d=m(d,numeric.epsilon);var o,p,q,r=numeric.identity(i),s=numeric.dot,t=numeric.inv,u=numeric.sub,v=numeric.add,w=numeric.tensor,x=numeric.div,y=numeric.mul,z=numeric.all,A=numeric.isFinite,B=numeric.neg,C=0,D,E,F,G,H,I,J,K,L,M,N,O,P="";p=e(c);while(C<f){typeof g=="function"&&g(C,c,j,p,r);if(!z(A(p))){P="Gradient has Infinity or NaN";break}o=B(s(r,p));if(!z(A(o))){P="Search direction has Infinity or NaN";break}M=n(o);if(M<d){P="Newton step smaller than tol";break}L=1,l=s(p,o);while(C<f){if(L*M<d)break;E=y(o,L),F=v(c,E),k=b(F);if(k-j>=.1*L*l){L*=.5,++C;continue}break}if(L*M<d){P="Line search step size smaller than tol";break}if(C===f){P="maxit reached during line search";break}q=e(F),G=u(q,p),J=s(G,E),H=s(r,G),r=u(v(r,y((J+s(G,H))/(J*J),w(E,E))),x(v(w(H,E),w(E,H)),J)),c=F,j=k,p=q,++C}return{solution:c,f:j,gradient:p,invHessian:r,iterations:C,message:P}},numeric.Dopri=function(b,c,d,e,f,g,h){this.x=b,this.y=c,this.f=d,this.ymid=e,this.iterations=f,this.events=h,this.message=g},numeric.Dopri.prototype._at=function(b,c){function d(a){return a*a}var e=this,f=e.x,g=e.y,h=e.f,i=e.ymid,j=f.length,k,l,m,n,o,p,b,q=Math.floor,r,s=.5,t=numeric.add,u=numeric.mul,v=numeric.sub,w,x,y;return k=f[c],l=f[c+1],n=g[c],o=g[c+1],r=l-k,m=k+s*r,p=i[c],w=v(h[c],u(n,1/(k-m)+2/(k-l))),x=v(h[c+1],u(o,1/(l-m)+2/(l-k))),y=[d(b-l)*(b-m)/d(k-l)/(k-m),d(b-k)*d(b-l)/d(k-m)/d(l-m),d(b-k)*(b-m)/d(l-k)/(l-m),(b-k)*d(b-l)*(b-m)/d(k-l)/(k-m),(b-l)*d(b-k)*(b-m)/d(k-l)/(l-m)],t(t(t(t(u(n,y[0]),u(p,y[1])),u(o,y[2])),u(w,y[3])),u(x,y[4]))},numeric.Dopri.prototype.at=function(b){var c,d,e,f=Math.floor;if(typeof b!="number"){var g=b.length,h=Array(g);for(c=g-1;c!==-1;--c)h[c]=this.at(b[c]);return h}var i=this.x;c=0,d=i.length-1;while(d-c>1)e=f(.5*(c+d)),i[e]<=b?c=e:d=e;return this._at(b,c)},numeric.dopri=function(b,c,d,e,f,g,h){typeof f=="undefined"&&(f=1e-6),typeof g=="undefined"&&(g=1e3);var i=[b],j=[d],k=[e(b,d)],l,m,n,o,p,q,r=[],s=.2,t=[.075,.225],u=[44/45,-56/15,32/9],v=[19372/6561,-25360/2187,64448/6561,-212/729],w=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],x=[35/384,0,500/1113,125/192,-2187/6784,11/84],y=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],z=[.2,.3,.8,8/9,1,1],A=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],B=0,C,D,E=(c-b)/10,F=0,G=numeric.add,H=numeric.mul,I,J,K=Math.max,L=Math.min,M=Math.abs,N=numeric.norminf,O=Math.pow,P=numeric.any,Q=numeric.lt,R=numeric.and,S=numeric.sub,T,U,V,W=new numeric.Dopri(i,j,k,r,-1,"");typeof h=="function"&&(T=h(b,d));while(b<c&&F<g){++F,b+E>c&&(E=c-b),l=e(b+z[0]*E,G(d,H(s*E,k[B]))),m=e(b+z[1]*E,G(G(d,H(t[0]*E,k[B])),H(t[1]*E,l))),n=e(b+z[2]*E,G(G(G(d,H(u[0]*E,k[B])),H(u[1]*E,l)),H(u[2]*E,m))),o=e(b+z[3]*E,G(G(G(G(d,H(v[0]*E,k[B])),H(v[1]*E,l)),H(v[2]*E,m)),H(v[3]*E,n))),p=e(b+z[4]*E,G(G(G(G(G(d,H(w[0]*E,k[B])),H(w[1]*E,l)),H(w[2]*E,m)),H(w[3]*E,n)),H(w[4]*E,o))),I=G(G(G(G(G(d,H(k[B],E*x[0])),H(m,E*x[2])),H(n,E*x[3])),H(o,E*x[4])),H(p,E*x[5])),q=e(b+E,I),C=G(G(G(G(G(H(k[B],E*A[0]),H(m,E*A[2])),H(n,E*A[3])),H(o,E*A[4])),H(p,E*A[5])),H(q,E*A[6])),typeof C=="number"?J=M(C):J=N(C);if(J>f){E=.2*E*O(f/J,.25);if(b+E===b){W.msg="Step size became too small";break}continue}r[B]=G(G(G(G(G(G(d,H(k[B],E*y[0])),H(m,E*y[2])),H(n,E*y[3])),H(o,E*y[4])),H(p,E*y[5])),H(q,E*y[6])),++B,i[B]=b+E,j[B]=I,k[B]=q;if(typeof h=="function"){var X,Y=b,Z=b+.5*E,$;U=h(Z,r[B-1]),V=R(Q(T,0),Q(0,U)),P(V)||(Y=Z,Z=b+E,T=U,U=h(Z,I),V=R(Q(T,0),Q(0,U)));if(P(V)){var _,ab,bb,cb,db=0,eb=1,fb=1;for(;;){if(typeof T=="number")$=(fb*U*Y-eb*T*Z)/(fb*U-eb*T);else{$=Z;for(D=T.length-1;D!==-1;--D)T[D]<0&&U[D]>0&&($=L($,(fb*U[D]*Y-eb*T[D]*Z)/(fb*U[D]-eb*T[D])))}if($<=Y||$>=Z)break;X=W._at($,B-1),cb=h($,X),bb=R(Q(T,0),Q(0,cb)),P(bb)?(Z=$,U=cb,V=bb,fb=1,db===-1?eb*=.5:eb=1,db=-1):(Y=$,T=cb,eb=1,db===1?fb*=.5:fb=1,db=1)}return I=W._at(.5*(b+$),B-1),W.f[B]=e($,X),W.x[B]=$,W.y[B]=X,W.ymid[B-1]=I,W.events=V,W.iterations=F,W}}b+=E,d=I,T=U,E=L(.8*E*O(f/J,.25),4*E)}return W.iterations=F,W},numeric.seedrandom={pow:Math.pow,random:Math.random},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;e.S=[],e.c=[],f||(a=[f++]);while(g<c)e.S[g]=g++;for(g=0;g<c;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(b){var d=e.S,f=k(e.i+1),g=d[f],h=k(e.j+g),i=d[h];d[f]=i,d[h]=g;var j=d[k(g+i)];while(--b)f=k(f+1),g=d[f],h=k(h+g),i=d[h],d[f]=i,d[h]=g,j=j*c+d[k(g+i)];return e.i=f,e.j=h,j},e.g(c)}function i(a,b,c,d,e){c=[],e=typeof a;if(b&&e=="object")for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+(e!="string"?"\0":"")}function j(a,b,c,d){a+="",c=0;for(d=0;d<a.length;d++)b[k(d)]=k((c^=b[k(d)]*19)+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(l,m){var n=[],o;return l=j(i(m?[l,a]:arguments.length?l:[(new Date).getTime(),a,window],3),n),o=new h(n),j(o.S,a),b.random=function(){var b=o.g(d),h=g,i=0;while(b<e)b=(b+i)*c,h*=c,i=o.g(1);while(b>=f)b/=2,h/=2,i>>>=1;return(b+i)/h},l},g=b.pow(c,d),e=b.pow(2,e),f=e*2,j(b.random(),a)}([],numeric.seedrandom,256,6,52),function(a){function b(a){if(typeof a!="object")return a;var c=[],d,e=a.length;for(d=0;d<e;d++)c[d+1]=b(a[d]);return c}function c(a){if(typeof a!="object")return a;var b=[],d,e=a.length;for(d=1;d<e;d++)b[d-1]=c(a[d]);return b}function d(a,b,c){var d,e,f,g,h;for(f=1;f<=c;f+=1){a[f][f]=1/a[f][f],h=-a[f][f];for(d=1;d<f;d+=1)a[d][f]=h*a[d][f];g=f+1;if(c<g)break;for(e=g;e<=c;e+=1){h=a[f][e],a[f][e]=0;for(d=1;d<=f;d+=1)a[d][e]=a[d][e]+h*a[d][f]}}}function e(a,b,c,d){var e,f,g,h;for(f=1;f<=c;f+=1){h=0;for(e=1;e<f;e+=1)h+=a[e][f]*d[e];d[f]=(d[f]-h)/a[f][f]}for(g=1;g<=c;g+=1){f=c+1-g,d[f]=d[f]/a[f][f],h=-d[f];for(e=1;e<f;e+=1)d[e]=d[e]+h*a[e][f]}}function f(a,b,c,d){var e,f,g,h,i,j;for(f=1;f<=c;f+=1){d[1]=f,j=0,g=f-1;if(g<1){j=a[f][f]-j;if(j<=0)break;a[f][f]=Math.sqrt(j)}else{for(h=1;h<=g;h+=1){i=a[h][f];for(e=1;e<h;e+=1)i-=a[e][f]*a[e][h];i/=a[h][h],a[h][f]=i,j+=i*i}j=a[f][f]-j;if(j<=0)break;a[f][f]=Math.sqrt(j)}d[1]=0}}function g(a,b,c,g,h,i,j,k,l,m,n,o,p,q,r,s){function U(){q[1]=q[1]+1,v=C;for(t=1;t<=m;t+=1){v+=1,I=-k[t];for(u=1;u<=g;u+=1)I+=j[u][t]*h[u];Math.abs(I)<Q&&(I=0);if(t>n)r[v]=I;else{r[v]=-Math.abs(I);if(I>0){for(u=1;u<=g;u+=1)j[u][t]=-j[u][t];k[t]=-k[t]}}}for(t=1;t<=p;t+=1)r[C+o[t]]=0;E=0,H=0;for(t=1;t<=m;t+=1)r[C+t]<H*r[G+t]&&(E=t,H=r[C+t]/r[G+t]);return E===0?999:0}function V(){for(t=1;t<=g;t+=1){I=0;for(u=1;u<=g;u+=1)I+=a[u][t]*j[u][E];r[t]=I}w=z;for(t=1;t<=g;t+=1)r[w+t]=0;for(u=p+1;u<=g;u+=1)for(t=1;t<=g;t+=1)r[w+t]=r[w+t]+a[t][u]*r[u];O=!0;for(t=p;t>=1;t-=1){I=r[t],v=B+t*(t+3)/2,w=v-t;for(u=t+1;u<=p;u+=1)I-=r[v]*r[A+u],v+=u;I/=r[w],r[A+t]=I;if(o[t]<n)break;if(I<0)break;O=!1,y=t}if(!O){J=r[D+y]/r[A+y];for(t=1;t<=p;t+=1){if(o[t]<n)break;if(r[A+t]<0)break;H=r[D+t]/r[A+t],H<J&&(J=H,y=t)}}I=0;for(t=z+1;t<=z+g;t+=1)I+=r[t]*r[t];if(Math.abs(I)<=Q){if(O)return s[1]=1,999;for(t=1;t<=p;t+=1)r[D+t]=r[D+t]-J*r[A+t];return r[D+p+1]=r[D+p+1]+J,700}I=0;for(t=1;t<=g;t+=1)I+=r[z+t]*j[t][E];K=-r[C+E]/I,P=!0,O||J<K&&(K=J,P=!1);for(t=1;t<=g;t+=1)h[t]=h[t]+K*r[z+t],Math.abs(h[t])<Q&&(h[t]=0);i[1]=i[1]+K*I*(K/2+r[D+p+1]);for(t=1;t<=p;t+=1)r[D+t]=r[D+t]-K*r[A+t];r[D+p+1]=r[D+p+1]+K;if(!P){I=-k[E];for(u=1;u<=g;u+=1)I+=h[u]*j[u][E];if(E>n)r[C+E]=I;else{r[C+E]=-Math.abs(I);if(I>0){for(u=1;u<=g;u+=1)j[u][E]=-j[u][E];k[E]=-k[E]}}return 700}p+=1,o[p]=E,v=B+(p-1)*p/2+1;for(t=1;t<=p-1;t+=1)r[v]=r[t],v+=1;if(p===g)r[v]=r[g];else{for(t=g;t>=p+1;t-=1){if(r[t]===0)break;L=Math.max(Math.abs(r[t-1]),Math.abs(r[t])),M=Math.min(Math.abs(r[t-1]),Math.abs(r[t])),r[t-1]>=0?H=Math.abs(L*Math.sqrt(1+M*M/(L*L))):H=-Math.abs(L*Math.sqrt(1+M*M/(L*L))),L=r[t-1]/H,M=r[t]/H;if(L===1)break;if(L===0){r[t-1]=M*H;for(u=1;u<=g;u+=1)H=a[u][t-1],a[u][t-1]=a[u][t],a[u][t]=H}else{r[t-1]=H,N=M/(1+L);for(u=1;u<=g;u+=1)H=L*a[u][t-1]+M*a[u][t],a[u][t]=N*(a[u][t-1]+H)-a[u][t],a[u][t-1]=H}}r[v]=r[p]}return 0}function W(){v=B+y*(y+1)/2+1,w=v+y;if(r[w]===0)return 798;L=Math.max(Math.abs(r[w-1]),Math.abs(r[w])),M=Math.min(Math.abs(r[w-1]),Math.abs(r[w])),r[w-1]>=0?H=Math.abs(L*Math.sqrt(1+M*M/(L*L))):H=-Math.abs(L*Math.sqrt(1+M*M/(L*L))),L=r[w-1]/H,M=r[w]/H;if(L===1)return 798;if(L===0){for(t=y+1;t<=p;t+=1)H=r[w-1],r[w-1]=r[w],r[w]=H,w+=t;for(t=1;t<=g;t+=1)H=a[t][y],a[t][y]=a[t][y+1],a[t][y+1]=H}else{N=M/(1+L);for(t=y+1;t<=p;t+=1)H=L*r[w-1]+M*r[w],r[w]=N*(r[w-1]+H)-r[w],r[w-1]=H,w+=t;for(t=1;t<=g;t+=1)H=L*a[t][y]+M*a[t][y+1],a[t][y+1]=N*(a[t][y]+H)-a[t][y+1],a[t][y]=H}return 0}function X(){w=v-y;for(t=1;t<=y;t+=1)r[w]=r[v],v+=1,w+=1;return r[D+y]=r[D+y+1],o[y]=o[y+1],y+=1,y<p?797:0}function Y(){return r[D+p]=r[D+p+1],r[D+p+1]=0,o[p]=0,p-=1,q[2]=q[2]+1,0}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;F=Math.min(g,m),v=2*g+F*(F+5)/2+2*m+1,Q=1e-60;do Q+=Q,R=1+.1*Q,S=1+.2*Q;while(R<=1||S<=1);for(t=1;t<=g;t+=1)r[t]=b[t];for(t=g+1;t<=v;t+=1)r[t]=0;for(t=1;t<=m;t+=1)o[t]=0;x=[];if(s[1]===0){f(a,c,g,x);if(x[1]!==0){s[1]=2;return}e(a,c,g,b),d(a,c,g)}else{for(u=1;u<=g;u+=1){h[u]=0;for(t=1;t<=u;t+=1)h[u]=h[u]+a[t][u]*b[t]}for(u=1;u<=g;u+=1){b[u]=0;for(t=u;t<=g;t+=1)b[u]=b[u]+a[u][t]*h[t]}}i[1]=0;for(u=1;u<=g;u+=1){h[u]=b[u],i[1]=i[1]+r[u]*h[u],r[u]=0;for(t=u+1;t<=g;t+=1)a[t][u]=0}i[1]=-i[1]/2,s[1]=0,z=g,A=z+g,D=A+F,B=D+F+1,C=B+F*(F+1)/2,G=C+m;for(t=1;t<=m;t+=1){I=0;for(u=1;u<=g;u+=1)I+=j[u][t]*j[u][t];r[G+t]=Math.sqrt(I)}p=0,q[1]=0,q[2]=0,T=0;for(;;){T=U();if(T===999)return;for(;;){T=V();if(T===0)break;if(T===999)return;if(T===700)if(y===p)Y();else{for(;;){W(),T=X();if(T!==797)break}Y()}}}}function h(a,d,e,f,h,i){a=b(a),d=b(d),e=b(e);var j,k,l,m,n,o=[],p=[],q=[],r=[],s=[],t;h=h||0,i=i?b(i):[undefined,0],f=f?b(f):[],k=a.length-1,l=e[1].length-1;if(!f)for(j=1;j<=l;j+=1)f[j]=0;for(j=1;j<=l;j+=1)p[j]=0;m=0,n=Math.min(k,l);for(j=1;j<=k;j+=1)q[j]=0;o[1]=0;for(j=1;j<=2*k+n*(n+5)/2+2*l+1;j+=1)r[j]=0;for(j=1;j<=2;j+=1)s[j]=0;return g(a,d,k,k,q,o,e,f,k,l,h,p,m,s,r,i),t="",i[1]===1&&(t="constraints are inconsistent, no solution!"),i[1]===2&&(t="matrix D in quadratic function is not positive definite!"),{solution:c(q),value:c(o),unconstrained_solution:c(d),iterations:c(s),iact:c(p),message:t}}a.solveQP=h}(numeric),numeric.svd=function(b){function r(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):b==0?a:b*Math.sqrt(1+a*a/b/b)}var c,d=numeric.epsilon,e=1e-64/d,f=50,g=0,h=0,i=0,j=0,k=0,l=numeric.clone(b),m=l.length,n=l[0].length;if(m<n)throw"Need more rows than columns";var o=new Array(n),p=new Array(n);for(h=0;h<n;h++)o[h]=p[h]=0;var q=numeric.rep([n,n],0),s=0,t=0,u=0,v=0,w=0,x=0,y=0;for(h=0;h<n;h++){o[h]=t,y=0,k=h+1;for(i=h;i<m;i++)y+=l[i][h]*l[i][h];if(y<=e)t=0;else{s=l[h][h],t=Math.sqrt(y),s>=0&&(t=-t),u=s*t-y,l[h][h]=s-t;for(i=k;i<n;i++){y=0;for(j=h;j<m;j++)y+=l[j][h]*l[j][i];s=y/u;for(j=h;j<m;j++)l[j][i]+=s*l[j][h]}}p[h]=t,y=0;for(i=k;i<n;i++)y+=l[h][i]*l[h][i];if(y<=e)t=0;else{s=l[h][h+1],t=Math.sqrt(y),s>=0&&(t=-t),u=s*t-y,l[h][h+1]=s-t;for(i=k;i<n;i++)o[i]=l[h][i]/u;for(i=k;i<m;i++){y=0;for(j=k;j<n;j++)y+=l[i][j]*l[h][j];for(j=k;j<n;j++)l[i][j]+=y*o[j]}}w=Math.abs(p[h])+Math.abs(o[h]),w>v&&(v=w)}for(h=n-1;h!=-1;h+=-1){if(t!=0){u=t*l[h][h+1];for(i=k;i<n;i++)q[i][h]=l[h][i]/u;for(i=k;i<n;i++){y=0;for(j=k;j<n;j++)y+=l[h][j]*q[j][i];for(j=k;j<n;j++)q[j][i]+=y*q[j][h]}}for(i=k;i<n;i++)q[h][i]=0,q[i][h]=0;q[h][h]=1,t=o[h],k=h}for(h=n-1;h!=-1;h+=-1){k=h+1,t=p[h];for(i=k;i<n;i++)l[h][i]=0;if(t!=0){u=l[h][h]*t;for(i=k;i<n;i++){y=0;for(j=k;j<m;j++)y+=l[j][h]*l[j][i];s=y/u;for(j=h;j<m;j++)l[j][i]+=s*l[j][h]}for(i=h;i<m;i++)l[i][h]=l[i][h]/t}else for(i=h;i<m;i++)l[i][h]=0;l[h][h]+=1}d*=v;for(j=n-1;j!=-1;j+=-1)for(var z=0;z<f;z++){var A=!1;for(k=j;k!=-1;k+=-1){if(Math.abs(o[k])<=d){A=!0;break}if(Math.abs(p[k-1])<=d)break}if(!A){g=0,y=1;var B=k-1;for(h=k;h<j+1;h++){s=y*o[h],o[h]=g*o[h];if(Math.abs(s)<=d)break;t=p[h],u=r(s,t),p[h]=u,g=t/u,y=-s/u;for(i=0;i<m;i++)w=l[i][B],x=l[i][h],l[i][B]=w*g+x*y,l[i][h]=-w*y+x*g}}x=p[j];if(k==j){if(x<0){p[j]=-x;for(i=0;i<n;i++)q[i][j]=-q[i][j]}break}if(z>=f-1)throw"Error: no convergence.";v=p[k],w=p[j-1],t=o[j-1],u=o[j],s=((w-x)*(w+x)+(t-u)*(t+u))/(2*u*w),t=r(s,1),s<0?s=((v-x)*(v+x)+u*(w/(s-t)-u))/v:s=((v-x)*(v+x)+u*(w/(s+t)-u))/v,g=1,y=1;for(h=k+1;h<j+1;h++){t=o[h],w=p[h],u=y*t,t=g*t,x=r(s,u),o[h-1]=x,g=s/x,y=u/x,s=v*g+t*y,t=-v*y+t*g,u=w*y,w*=g;for(i=0;i<n;i++)v=q[i][h-1],x=q[i][h],q[i][h-1]=v*g+x*y,q[i][h]=-v*y+x*g;x=r(s,u),p[h-1]=x,g=s/x,y=u/x,s=g*t+y*w,v=-y*t+g*w;for(i=0;i<m;i++)w=l[i][h-1],x=l[i][h],l[i][h-1]=w*g+x*y,l[i][h]=-w*y+x*g}o[k]=0,o[j]=s,p[j]=v}for(h=0;h<p.length;h++)p[h]<d&&(p[h]=0);for(h=0;h<n;h++)for(i=h-1;i>=0;i--)if(p[i]<p[h]){g=p[i],p[i]=p[h],p[h]=g;for(j=0;j<l.length;j++)c=l[j][h],l[j][h]=l[j][i],l[j][i]=c;for(j=0;j<q.length;j++)c=q[j][h],q[j][h]=q[j][i],q[j][i]=c;h=i}return{U:l,S:p,V:q}};