/*
 * Crypto-JS v2.4.0
 * http://code.google.com/p/crypto-js/
 * Copyright (c) 2011, Jeff Mott. All rights reserved.
 * http://code.google.com/p/crypto-js/wiki/License
 */
(function(){var j=Crypto,g=j.util,l=j.charenc.UTF8,d=[],b=[],k,i=j.Rabbit={encrypt:function(a,c){var f=l.stringToBytes(a),e=g.randomBytes(8),h=c.constructor==String?j.PBKDF2(c,e,32,{asBytes:true}):c;i._rabbit(f,h,g.bytesToWords(e));return g.bytesToBase64(e.concat(f))},decrypt:function(a,c){var f=g.base64ToBytes(a),e=f.splice(0,8),h=c.constructor==String?j.PBKDF2(c,e,32,{asBytes:true}):c;i._rabbit(f,h,g.bytesToWords(e));return l.bytesToString(f)},_rabbit:function(a,c,f){i._keysetup(c);f&&i._ivsetup(f);
c=[];for(f=0;f<a.length;f++){if(f%16==0){i._nextstate();c[0]=d[0]^d[5]>>>16^d[3]<<16;c[1]=d[2]^d[7]>>>16^d[5]<<16;c[2]=d[4]^d[1]>>>16^d[7]<<16;c[3]=d[6]^d[3]>>>16^d[1]<<16;for(var e=0;e<4;e++)c[e]=(c[e]<<8|c[e]>>>24)&16711935|(c[e]<<24|c[e]>>>8)&4278255360;for(e=120;e>=0;e-=8)c[e/8]=c[e>>>5]>>>24-e%32&255}a[f]^=c[f%16]}},_keysetup:function(a){d[0]=a[0];d[2]=a[1];d[4]=a[2];d[6]=a[3];d[1]=a[3]<<16|a[2]>>>16;d[3]=a[0]<<16|a[3]>>>16;d[5]=a[1]<<16|a[0]>>>16;d[7]=a[2]<<16|a[1]>>>16;b[0]=g.rotl(a[2],16);
b[2]=g.rotl(a[3],16);b[4]=g.rotl(a[0],16);b[6]=g.rotl(a[1],16);b[1]=a[0]&4294901760|a[1]&65535;b[3]=a[1]&4294901760|a[2]&65535;b[5]=a[2]&4294901760|a[3]&65535;b[7]=a[3]&4294901760|a[0]&65535;for(a=k=0;a<4;a++)i._nextstate();for(a=0;a<8;a++)b[a]^=d[a+4&7]},_ivsetup:function(a){var c=g.endian(a[0]);a=g.endian(a[1]);var f=c>>>16|a&4294901760,e=a<<16|c&65535;b[0]^=c;b[1]^=f;b[2]^=a;b[3]^=e;b[4]^=c;b[5]^=f;b[6]^=a;b[7]^=e;for(c=0;c<4;c++)i._nextstate()},_nextstate:function(){for(var a=[],c=0;c<8;c++)a[c]=
b[c];b[0]=b[0]+1295307597+k>>>0;b[1]=b[1]+3545052371+(b[0]>>>0<a[0]>>>0?1:0)>>>0;b[2]=b[2]+886263092+(b[1]>>>0<a[1]>>>0?1:0)>>>0;b[3]=b[3]+1295307597+(b[2]>>>0<a[2]>>>0?1:0)>>>0;b[4]=b[4]+3545052371+(b[3]>>>0<a[3]>>>0?1:0)>>>0;b[5]=b[5]+886263092+(b[4]>>>0<a[4]>>>0?1:0)>>>0;b[6]=b[6]+1295307597+(b[5]>>>0<a[5]>>>0?1:0)>>>0;b[7]=b[7]+3545052371+(b[6]>>>0<a[6]>>>0?1:0)>>>0;k=b[7]>>>0<a[7]>>>0?1:0;a=[];for(c=0;c<8;c++){var f=d[c]+b[c]>>>0,e=f&65535,h=f>>>16;a[c]=((e*e>>>17)+e*h>>>15)+h*h^((f&4294901760)*
f>>>0)+((f&65535)*f>>>0)>>>0}d[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16);d[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7];d[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16);d[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1];d[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16);d[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3];d[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16);d[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]}}})();
